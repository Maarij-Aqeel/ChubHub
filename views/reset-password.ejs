<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>UChub â€” Reset Password</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="/css/auth.css" />
  </head>
  <body>
    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    <!-- Reset Password Card -->
    <div class="auth-card">
      <h2>
        <i class="fas fa-lock"></i>
        UChub
      </h2>
      <p class="subtitle">Enter your new password</p>

      <form action="/reset-password" method="POST">
        <input type="hidden" name="token" value="<%= token %>" />

        <div class="form-group">
          <label for="password">
            <i
              class="fas fa-lock"
              style="color: #f59e0b; margin-right: 6px"
            ></i>
            New Password
          </label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Enter your new password"
            required
            autocomplete="new-password"
            minlength="8"
          />
        </div>

        <div class="form-group">
          <label for="confirmPassword">
            <i
              class="fas fa-lock"
              style="color: #f59e0b; margin-right: 6px"
            ></i>
            Confirm Password
          </label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            placeholder="Confirm your new password"
            required
            autocomplete="new-password"
            minlength="8"
          />
        </div>

        <button type="submit">
          <i class="fas fa-save"></i>
          Reset Password
        </button>
      </form>

      <div class="form-divider">
        <span>Remember your credentials?</span>
      </div>

      <p>
        <a href="/login">Back to login</a>
      </p>
    </div>

    <!-- Toast Script -->
    <script>
      window.addEventListener('DOMContentLoaded', function() {
        var flash = <%- JSON.stringify(flash) %>;
        if (flash && (flash.error || flash.message)) {
          showToast(
            flash.error ? flash.error : flash.message,
            flash.error ? 'error' : 'success'
          );
        }
      });

      function showToast(msg, type) {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        const isError = type === 'error';

        toast.className = 'toast ' + (isError ? 'toast-error' : 'toast-success');

        const icon = document.createElement('i');
        icon.className = isError ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';

        toast.appendChild(icon);

        const message = document.createElement('span');
        message.textContent = msg;
        toast.appendChild(message);

        container.appendChild(toast);

        setTimeout(() => {
          toast.classList.add('show');
        }, 100);

        setTimeout(() => {
          toast.classList.remove('show');
          setTimeout(() => toast.remove(), 500);
        }, 3400);
      }
    </script>
  </body>
</html>
